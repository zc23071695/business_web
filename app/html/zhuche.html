<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <link rel="stylesheet" href="../css/zhuche.css">
    <link rel="stylesheet" href="../css/common.css">
    <link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../css/index.css">

</head>

<body>
    <div id="header">
        <div class="header_loog">
            凡客 vancl
        </div>
        <a href="X" class="header_right">帮助</a>
    </div>
    <div>
        <div id="mian">
            <div class="mian_left">
                <div class="tupian">
                </div>
                <p>
                    <span> 凡客vancl </span>
                    | 互联网快时尚
                </p>
            </div>
            <div class="mian_dengru">
                <p class="mian_dengru_top">
                    <span>注册新用户</span>
                    <span>我已经注册啦账户，现在<a href="dengru.html">登录</a></span>
                </p>
                <form class="form_box" autocomplete="on" onsubmit="return false">
                    <div class="form-group">
                        <label for="email">用户名</label>
                        <input type="text" class="form-control usern" id="username" name="username" placeholder="请输入用户名"
                            data-error="需要输入6-13位的字母或者下划线">
                        <p class="panduan"></p>
                    </div>
                    <div class="form-group">
                        <label for="email">手机号</label>
                        <input required type="text" class="form-control" id="phone" name="phone" placeholder="请输入手机号"
                            data-error="手机号格式不正确">
                        <p class=""></p>
                    </div>
                    <div class="form-group">
                        <label for="email">输入密码</label>
                        <input placeholder="" type="password" class="form-control" id="password" name="password"
                            placeholder="请重新输入密码">
                        <p class=""></p>
                    </div>
                    <div class="form-group">
                        <label for="email">再次输入密码</label>
                        <input type="password" class="form-control" name="repassword" id="repassword"
                            placeholder="请重新输入密码" data-error="两次密码输入不一致">
                        <p class=""></p>
                    </div>
                    <button name="submit" type="submit" class=" btn-success">确定</button>
                </form>
            </div>
        </div>
    </div>
    <div id="footArea">
        <div class="footBottom">
            <div class="footBottomTab">
                <p> Copyright 2007 - 2019 vancl.com All Rights Reserved 京ICP证100557号
                    京公网安备11011502002400号 出版物经营许可证新出发京批字第直110138号</p>

                <p> 凡客诚品（北京）科技有限公司</p>
            </div>
        </div>
        <span class="blank20"></span>
        <div class="subFooter">
            <a class="redLogo" href=""></a>
            <span class="costumeOrg" href=""></span>
            <a class="wsjyBzzx" href=""></a>
            <a class="vanclMsg" href=""></a>
            <a class="vanclqingNian" href=""></a>

            <a href="" style="display: inline-block;">
                <img src="images/kexin_brand_for_others.png" alt="" style="width: 120px; height: 39px;">
            </a>
        </div>
    </div>


    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">提交成功</h4>
                </div>
                <div class="modal-body">
                    即将跳转...
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary b-commit">确定</button>
                </div>
            </div>
        </div>
    </div>
    <script src="../js/ajax3.0.0.js"></script>
    <script src="../js/jquery.js"></script>
    <script src="../js/api.js"></script>
    <script src="../js/001cookie.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script>
    <script>
        var $form = document.querySelector('.form_box');
        var $anniu = document.querySelector(".btn-success");
        var $panduan = document.querySelector(".panduan")
        var $allinput = document.querySelectorAll("input");
        $allinput[0].onblur = function () {
            var text = this.value;
            younamen = text;
            console.log(younamen);
            var reg = /^\d{8,16}$/;
            var $p = this.nextElementSibling;

            // if(text===""){
            //    $p.innerHTML="内容不可以为空" ;

            //    }
            if (reg.test(text)) {
                $p.innerHTML = "验证成功";
                $p.className = "success";
            }
            else {
                $p.innerHTML = "不成功";
                $p.className = "fail"
            }
        }
        $allinput[1].onblur = function () {
            var text = this.value;

            var reg = /^1[34578]\d{9}$/;
            var $p = this.nextElementSibling;
            // if(text===""){
            //     $p.innerHTML="内容不可以为空" ;

            //    }
            if (reg.test(text)) {
                $p.innerHTML = "验证成功";
                $p.className = "success"
            }
            else {
                $p.innerHTML = "不成功";
                $p.className = "fail"
            }
        }
        $allinput[2].onblur = function () {
            var text = this.value;
            youpossword = text;

            var reg = /^\w{4,16}/;
            var $p = this.nextElementSibling;
            // if(text===""){
            //    $p.innerHTML="内容不可以为空" ;
            //    }

            if (reg.test(text)) {
                $p.innerHTML = "验证成功";
                $p.className = "success";
            }
            else {
                $p.innerHTML = "不成功";
                $p.className = "fail"
            }
            $allinput[3].focus();
        }
        $allinput[3].onblur = function () {
            var text = this.value;
            var youragainpossword = text;
            var $p = this.nextElementSibling;
            // if(text===""){
            //     $p.innerHTML="内容不可以为空" ;
            //    }
            if (text === $allinput[2].value) {
                $p.innerHTML = "验证成功";
                $p.className = "success";
            }
            else {
                $p.innerHTML = "不成功";
                $p.className = "fail"
            }
        }



        $(".usern").change(function () {
            let val = this.value;
            let obj = {
                "username": val
            };

            sendAjax(apio.check_username, {
                method: 'POST',
                data: obj
            })
                .then(data => {
                    if (data.code === 200) {

                        $panduan.innerHTML = "用户名已经存在";
                        $allinput[0].focus();

                    }
                    else {

                        $panduan.innerHTML = "用户名可以用"
                    }

                });
        });

        $anniu.onclick = function () {
            for (let i = 0; i < $allinput.length; i++) {
                $allinput[i].focus();
                var p = $allinput[i].nextElementSibling;

                if (p.innerHTML === "不成功") {

                    return false;
                }
                else {
                    var obj = {
                        username: $form['username'].value,
                        password: $form['password'].value
                    };

                    sendAjax(apio.register, {
                        method: 'POST',
                        data: obj
                    })
                        .then(data => {
                            cookie.set("username", obj.username);
                            cookie.set("password", obj.password);
                            console.log(data);
                            if (data.code === 200) {
                                $('#myModal').modal("show");


                            }
                            else {
                                alert("由于网络原因")
                            }

                        });



                }

            }





            // if ($allinput[i].value === "") {
            //     p.innerHTML = "不成功";
            // }

        }

        //     var obj = {  username: $form['username'].value,
        //         password: $form['password'].value};

        //     sendAjax(apio.register, {
        //         method: 'POST',
        //         data: obj
        //     })
        //         .then(data => {
        //             cookie.set("username", obj.username);
        //             cookie.set("password", obj.password);
        //             console.log(data);
        //             if(data.code===200){
        //                 $('#myModal').modal("show");


        //              }
        //              else{
        //                  alert("由于网络原因")
        //              }

        //         });



        // }
        $(".b-commit").click(function () {
            location.href = "dengru.html";
        })
    </script>
</body>

</html>